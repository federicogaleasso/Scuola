<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galeasso Phaser</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>
    <script>
        let config = {
            type: Phaser.AUTO,
            width: 800,
            height: 540,
            backgroundColor: 0x000000,
            parent: "contenitore",
            // pixelArt: true,
            physics: {
                default: "arcade",
                arcade: {
                    gravity: {
                        y: 400
                    },
                    debug: true,
                }
            },
            scene: {
                preload: mioPreload,
                create: mioCreate,
                update: mioUpdate,
            }
        }

        //START GIOCO
        let gioco = new Phaser.Game(config)

        function mioPreload() {
            this.load.image("mioSfondo", "./assets/background.png");
            this.load.image("mioSprite", "./assets/sprite.png");
            this.load.image("mioSuolo", "./assets/floor.png");
            this.load.image("mioCuore", "./assets/life.png");
        }

        function mioCreate() {
            this.Suolo = this.physics.add.staticGroup({
                key: "mioSuolo",
                repeat: 3,
                setXY: {
                    x: 200,
                    y: 520,
                    stepY: -200,
                }
            });

            this.Cuore = this.physics.add.group({
                key: "mioCuore",
                repeat: 2,
                setXY: {
                    x: 30,
                    y: 200,
                    stepX: 30,
                }
            });

            this.Suolo.setDepth(10);
            this.Cuore.setDepth(10);

            this.add.image(320, 270, "mioSfondo").setScale(1.5);
            this.mioSprite = this.physics.add.sprite(200, 200, "mioSprite").setScale(3.5).setCollideWorldBounds(false);

            this.physics.add.collider(this.mioSprite, this.Suolo);

            this.physics.add.collider(this.Suolo, [this.mioSprite, this.Cuore]);

            this.physics.add.collider(this.mioSprite, this.Cuore)
            this.mioTasto = this.input.keyboard.createCursorKeys();

            this.physics.add.collider(this.mioSprite, this.Cuore, () => {
                console.log("")
            });
        }

        function mioUpdate() {
            if (this.mioTasto.right.isDown) {
                this.mioSprite.setVelocityX(300);
            }
            if (this.mioTasto.left.isDown) {
                this.mioSprite.setVelocityX(-300);
            }
            if (Phaser.Input.Keyboard.JustDown(this.mioTasto.space)) {
                this.mioSprite.setVelocityY(-150);
            }
        }
    </script>
</head>

<body>
    <div id="contenitore">
    </div>
</body>

</html>